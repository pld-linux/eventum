--- eventum-r3833/misc/cli/config.inc.php~	2009-02-10 09:30:34.000000000 +0200
+++ eventum-r3833/misc/cli/config.inc.php	2009-02-10 09:31:11.928169361 +0200
@@ -33,8 +33,7 @@
 set_time_limit(0);
 
 // definitions of path related variables
-define('APP_PATH', dirname(__FILE__) . '/');
-define('APP_INC_PATH', APP_PATH . 'include/');
-define('APP_PEAR_PATH', APP_INC_PATH . 'pear/');
+define('APP_INC_PATH', '/usr/share/eventum/cli/');
+define('APP_PEAR_PATH', '/usr/share/pear/');
 
 set_include_path(get_include_path() . PATH_SEPARATOR . APP_PEAR_PATH);
--- eventum/include/class.template_helper.php~	2007-01-30 18:52:59.020179406 +0200
+++ eventum/include/class.template_helper.php	2007-01-30 18:53:24.620759076 +0200
@@ -61,6 +61,7 @@
         $this->smarty = new Smarty;
         $this->smarty->template_dir = APP_TPL_PATH;
         $this->smarty->compile_dir = APP_TPL_COMPILE_PATH;
+        $this->smarty->plugins_dir  = array('/usr/share/eventum/include/smarty', 'plugins');
         $this->smarty->config_dir = '';
         $this->smarty->register_modifier("activateLinks", array('Link_Filter', 'activateLinks'));
         $this->smarty->register_modifier("formatCustomValue", array('Custom_Field', 'formatValue'));
--- ./include/class.monitor.php~	2005-02-22 21:50:49.000000000 +0200
+++ ./include/class.monitor.php	2005-02-22 23:04:50.000000000 +0200
@@ -157,6 +165,7 @@
                 'permission'       => 100,
             ),
         );
+        $required_directories = array();
         foreach ($required_directories as $dir_path => $options) {
             // check if directory exists
             if (!file_exists($dir_path)) {
--- ./include/class.misc.php	2005-10-26 17:17:17.000000000 +0300
+++ /tmp/class.misc.php	2005-10-26 17:30:12.000000000 +0300
@@ -607,7 +607,7 @@
      */
     function highlightQuotedReply($text)
     {
-        require_once(APP_SMARTY_PATH . "plugins/modifier.highlight_quoted.php");
+        require_once(APP_INC_PATH. "smarty/modifier.highlight_quoted.php");
         return smarty_modifier_highlight_quoted($text);
     }
 
--- eventum-r3615/init.php~	2008-06-05 00:02:42.833798000 +0300
+++ eventum-r3615/init.php	2008-06-05 00:02:58.229406819 +0300
@@ -26,7 +26,7 @@
 // | Authors: Elan Ruusam√§e <glen@delfi.ee>                               |
 // +----------------------------------------------------------------------+
 
-if (!file_exists(dirname(__FILE__) . '/config/config.php')) {
+if (!file_exists('/etc/webapps/eventum/config.php')) {
     Header('Location: setup/');
     exit;
 }
@@ -45,30 +45,30 @@
 
 // define base path
-define('APP_PATH', realpath(dirname(__FILE__)) . '/');
-define('APP_CONFIG_PATH', APP_PATH . 'config/');
+define('APP_PATH', '/usr/share/eventum/htdocs/');
+define('APP_CONFIG_PATH', '/etc/webapps/eventum/');
 
 // include local site config
 require_once APP_CONFIG_PATH . 'config.php';
 
 // define other paths
 if (!defined('APP_INC_PATH')) {
-    define('APP_INC_PATH', APP_PATH . 'include/');
+    define('APP_INC_PATH', '/usr/share/eventum/include/');
 }
 
 if (!defined('APP_PEAR_PATH')) {
-    define('APP_PEAR_PATH', APP_INC_PATH . 'pear/');
+    define('APP_PEAR_PATH', '/usr/share/pear/');
 }
 
 if (!defined('APP_TPL_PATH')) {
-    define('APP_TPL_PATH', APP_PATH . 'templates/');
+    define('APP_TPL_PATH', '/usr/share/eventum/templates/');
 }
 
 if (!defined('APP_TPL_COMPILE_PATH')) {
-    define('APP_TPL_COMPILE_PATH', APP_PATH . 'templates_c');
+    define('APP_TPL_COMPILE_PATH', '/var/cache/eventum/');
 }
 
 if (!defined('APP_SMARTY_PATH')) {
-    define('APP_SMARTY_PATH', APP_INC_PATH . 'Smarty/');
+    define('APP_SMARTY_PATH', '/usr/share/php/Smarty/');
 }
 
 if (!defined('APP_JPGRAPH_PATH')) {
@@ -76,7 +76,7 @@
 }
 
 if (!defined('APP_LOCKS_PATH')) {
-    define('APP_LOCKS_PATH', APP_PATH . 'locks/');
+    define('APP_LOCKS_PATH', '/var/run/eventum/');
 }
 
 if (!defined('APP_SETUP_FILE')) {
@@ -84,11 +84,11 @@
 }
 
 if (!defined('APP_SQL_PATCHES_PATH')) {
-    define('APP_SQL_PATCHES_PATH', APP_PATH . 'misc/upgrade/patches');
+    define('APP_SQL_PATCHES_PATH', '/usr/share/eventum/upgrade/patches');
 }
 
 if (!defined('APP_LOG_PATH')) {
-    define('APP_LOG_PATH', APP_PATH . 'logs/');
+    define('APP_LOG_PATH', '/var/log/eventum/');
 }
 
 if (!defined('APP_ROUTED_MAILS_SAVEDIR')) {
--- eventum/setup/index.php~	2007-01-30 20:04:32.306824546 +0200
+++ eventum/setup/index.php	2007-01-30 20:14:43.880555938 +0200
@@ -38,17 +38,17 @@
 set_time_limit(0);
 define('APP_CHARSET', 'UTF-8');
 define('APP_DEFAULT_LOCALE', 'en_US');
-define('APP_PATH', realpath(dirname(__FILE__) . '/..') . '/');
+define('APP_PATH', realpath(dirname(__FILE__) . '/../..') . '/');
 define('APP_INC_PATH', APP_PATH . 'include/');
 define('APP_PEAR_PATH', APP_INC_PATH . 'pear/');
-define('APP_SMARTY_PATH', APP_INC_PATH . 'Smarty/');
-define('APP_CONFIG_PATH', APP_PATH . 'config/');
+define('APP_SMARTY_PATH', '/usr/share/php/Smarty/');
+define('APP_CONFIG_PATH', '/etc/webapps/eventum/');
 define('APP_SETUP_FILE', APP_CONFIG_PATH . 'setup.php');
 define('APP_TPL_PATH', APP_PATH . 'templates/');
-define('APP_TPL_COMPILE_PATH', APP_PATH . 'templates_c');
-define('APP_LOG_PATH', APP_PATH . 'logs/');
+define('APP_TPL_COMPILE_PATH', '/var/cache/eventum');
+define('APP_LOG_PATH', '/var/log/eventum/');
 define('APP_ERROR_LOG', APP_LOG_PATH . 'errors.log');
-define('APP_LOCKS_PATH', APP_PATH . 'locks/');
+define('APP_LOCKS_PATH', '/var/run/eventum/');
 
 define('APP_BENCHMARK', false);
 
@@ -192,10 +192,6 @@
     if (ini_get('file_uploads') != "1") {
         $errors[] = "The 'file_uploads' directive needs to be enabled in your PHP.INI file in order for Eventum to work properly.";
     }
-    $error = checkPermissions(APP_CONFIG_PATH, "Directory '" . APP_CONFIG_PATH . "'", TRUE);
-    if (!empty($error)) {
-        $errors[] = $error;
-    }
     $error = checkPermissions(APP_LOCKS_PATH, "Directory '" . APP_LOCKS_PATH . "'", TRUE);
     if (!empty($error)) {
         $errors[] = $error;
@@ -329,10 +325,6 @@
     $setup_file_path = APP_SETUP_FILE;
 
     clearstatcache();
-    // check if config directory is writable
-    if (!is_writable(APP_CONFIG_PATH)) {
-        return "The file '" . APP_CONFIG_PATH . "' directory needs to be writable by the web server user. Please correct this problem and try again.";
-    }
     // need to create a random private key variable
     $private_key = '<?php
 $private_key = "' . md5(microtime()) . '";
--- eventum/misc/cli/eventum~	2007-01-30 20:33:31.435916994 +0200
+++ eventum/misc/cli/eventum	2007-01-30 20:34:58.717881130 +0200
@@ -13,3 +13,3 @@
 //
-require_once(dirname(__FILE__) . '/config.inc.php');
+require_once('/etc/eventum/cli.php');
 require_once(APP_INC_PATH . 'class.command_line.php');
--- eventum/misc/process_mail_queue.php~	2007-02-15 00:31:11.000000000 +0200
+++ eventum/misc/process_mail_queue.php	2007-02-15 01:02:15.704386785 +0200
@@ -30,7 +30,7 @@
 
 ini_set("memory_limit", "1024M");
 
-require_once(dirname(__FILE__) . "/../init.php");
+require_once(dirname(__FILE__) . "/htdocs/init.php");
 require_once(APP_INC_PATH . "db_access.php");
 require_once(APP_INC_PATH . "class.mail_queue.php");
 
--- eventum/misc/download_emails.php~	2007-02-15 00:31:11.000000000 +0200
+++ eventum/misc/download_emails.php	2007-02-15 01:02:56.183553358 +0200
@@ -30,7 +30,7 @@
 
 ini_set("memory_limit", "1024M");
 
-require_once(dirname(__FILE__) . "/../init.php");
+require_once(dirname(__FILE__) . "/htdocs/init.php");
 require_once(APP_INC_PATH . "class.support.php");
 require_once(APP_INC_PATH . "class.lock.php");
 require_once(APP_INC_PATH . "class.project.php");
--- eventum/misc/check_reminders.php~	2007-02-15 01:04:27.107937884 +0200
+++ eventum/misc/check_reminders.php	2007-02-15 01:10:20.645910516 +0200
@@ -29,7 +29,7 @@
 // @(#) $Id$
 //
 
-require_once(dirname(__FILE__) . "/../init.php");
+require_once(dirname(__FILE__) . "/htdocs/init.php");
 require_once(APP_INC_PATH . "db_access.php");
 require_once(APP_INC_PATH . "class.lock.php");
 require_once(APP_INC_PATH . "class.reminder.php");
--- eventum/misc/monitor.php~	2007-02-15 01:27:45.089473611 +0200
+++ eventum/misc/monitor.php	2007-02-15 01:28:05.849942411 +0200
@@ -27,7 +27,7 @@
 //
 // @(#) $Id$
 
-require_once(dirname(__FILE__) . "/../init.php");
+require_once(dirname(__FILE__) . "/htdocs/init.php");
 require_once(APP_INC_PATH . "class.monitor.php");
 
 // the disk partition in which eventum is stored in
--- eventum/misc/route_drafts.php~	2007-02-15 01:36:00.780666107 +0200
+++ eventum/misc/route_drafts.php	2007-02-15 01:36:28.141283847 +0200
@@ -27,7 +27,7 @@
 //
 // @(#) $Id$
 
-include_once(dirname(__FILE__) . "/../init.php");
+require_once(dirname(__FILE__) . "/htdocs/init.php");
 require_once(APP_INC_PATH . "db_access.php");
 require_once(APP_INC_PATH . "class.routing.php");
 
--- eventum/misc/route_emails.php~	2007-02-15 01:37:09.932227380 +0200
+++ eventum/misc/route_emails.php	2007-02-15 01:37:25.452577786 +0200
@@ -27,7 +27,7 @@
 //
 // @(#) $Id$
 
-include_once(dirname(__FILE__) . "/../init.php");
+require_once(dirname(__FILE__) . "/htdocs/init.php");
 require_once(APP_INC_PATH . "db_access.php");
 require_once(APP_INC_PATH . "class.routing.php");
 
--- eventum/misc/route_notes.php~	2007-02-15 01:38:04.393456957 +0200
+++ eventum/misc/route_notes.php	2007-02-15 01:38:18.973786135 +0200
@@ -27,7 +27,7 @@
 //
 // @(#) $Id$
 
-include_once(dirname(__FILE__) . "/../init.php");
+require_once(dirname(__FILE__) . "/htdocs/init.php");
 require_once(APP_INC_PATH . "db_access.php");
 require_once(APP_INC_PATH . "class.routing.php");
 
